{% extends 'users/base.html' %}

{% block title %}Lista de Servidores{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4" style="color: #4B8C2A; text-transform: uppercase;">Lista de Servidores</h2>
    <div class="text-end mb-3">
        {% if is_server_group_member %}
        <a href="{% url 'create_server' %}" class="btn btn-success" style="background-color: #4B8C2A; border: none;">Adicionar Servidor</a>
        {% endif %}
    </div>
    <table class="table table-striped table-hover" style="border: 2px solid #4B8C2A; border-radius: 10px;">
        <thead class="table-dark" style="background-color: #4B8C2A; color: white;">
            <tr>
                <th>Nome (IP)</th>  <!-- Alterado para incluir IP no cabeçalho -->
                <th>Link</th>
                <th>Usuário</th>
                {% if is_server_group_member %}
                <th>Senha</th>
                {% endif %}
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            {% for server in servers %}
            <tr>
                <td>{{ server.name }} ({{ server.ip_address }})</td>  <!-- Exibe o IP ao lado do nome -->
                <td><a href="{{ server.link }}" target="_blank" style="color: #006400;">{{ server.link }}</a></td>
                <td>{{ server.username }}</td>
                {% if is_server_group_member %}
                <td>
                    <span class="password-text" id="password-{{ server.pk }}" style="display:none;">{{ server.password }}</span>
                    <button type="button" class="btn btn-info btn-sm" onclick="togglePassword({{ server.pk }})">
                        <i class="fas fa-eye" id="eye-icon-{{ server.pk }}"></i>
                    </button>
                </td>
                {% endif %}
                <td>
                    {% if is_server_group_member %}
                    <a href="{% url 'edit_server' server.pk %}" class="btn btn-warning">Editar</a>
                    <form action="{% url 'delete_server' server.pk %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Deletar</button>
                    </form>
                    {% else %}
                    <span class="text-muted">Ações restritas</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="{% if is_server_group_member %}5{% else %}4{% endif %}" class="text-center">Nenhum servidor encontrado.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    function togglePassword(serverId) {
        const passwordText = document.getElementById('password-' + serverId);
        const eyeIcon = document.getElementById('eye-icon-' + serverId);
        if (passwordText.style.display === "none") {
            passwordText.style.display = "inline";
            eyeIcon.classList.remove('fa-eye');
            eyeIcon.classList.add('fa-eye-slash');
        } else {
            passwordText.style.display = "none";
            eyeIcon.classList.remove('fa-eye-slash');
            eyeIcon.classList.add('fa-eye');
        }
    }
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

{% endblock %}
